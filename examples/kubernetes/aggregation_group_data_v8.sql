INSERT INTO tbl_metering_group_data_5_min(created_ts, created_date, serial_id, group_id, phase_voltage_min, phase_voltage_max, phase_voltage_avg, line_voltage_min, line_voltage_max, line_voltage_avg, voltage_crest_factor_min, voltage_crest_factor_max, voltage_crest_factor_avg, phase_current_min, phase_current_max, phase_current_avg, current_crest_factor_min, current_crest_factor_max, current_crest_factor_avg, active_power_min, active_power_max, active_power_avg, reactive_power_min, reactive_power_max, reactive_power_avg, power_factor_min, power_factor_max, power_factor_avg, frequency_min, frequency_max, frequency_avg, thd_phase_voltage_min, thd_phase_voltage_max, thd_phase_voltage_avg, thd_phase_current_min, thd_phase_current_max, thd_phase_current_avg, temperature_min, temperature_max, temperature_avg, voltage_harmonics_min, voltage_harmonics_max, voltage_harmonics_avg, current_harmonics_min, current_harmonics_max, current_harmonics_avg, apparent_power_min, apparent_power_max, apparent_power_avg, inverter_conversion_efficiency_min, inverter_conversion_efficiency_max, inverter_conversion_efficiency_avg, electric_charge_min, electric_charge_max, electric_charge_avg, line_voltage_R_S_min, line_voltage_R_S_max, line_voltage_R_S_avg, line_voltage_S_T_min, line_voltage_S_T_max, line_voltage_S_T_avg, line_voltage_T_R_min, line_voltage_T_R_max, line_voltage_T_R_avg, accumulate_power_consumption_min, accumulate_power_consumption_max, accumulate_power_consumption_avg, dc_voltage_min, dc_voltage_max, dc_voltage_avg, dc_current_min, dc_current_max, dc_current_avg, dc_electric_power_min, dc_electric_power_max, dc_electric_power_avg, dc_ampere_min, dc_ampere_max, dc_ampere_avg, accumulate_dc_power_consumption_min, accumulate_dc_power_consumption_max, accumulate_dc_power_consumption_avg ) SELECT FLOOR(created_ts/ (1000000000 * 60 * 5 )) * 1000000000 * 60 * 5, NOW(), serial_id, group_id, min(phase_voltage) as phase_voltage_min, max(phase_voltage) as phase_voltage_max, avg(phase_voltage) as phase_voltage_avg, min(line_voltage) as line_voltage_min, max(line_voltage) as line_voltage_max, avg(line_voltage) as line_voltage_avg, min(voltage_crest_factor) as voltage_crest_factor_min, max(voltage_crest_factor) as voltage_crest_factor_max, avg(voltage_crest_factor) as voltage_crest_factor_avg, min(phase_current) as phase_current_min, max(phase_current) as phase_current_max, avg(phase_current) as phase_current_avg, min(current_crest_factor) as current_crest_factor_min, max(current_crest_factor) as current_crest_factor_max, avg(current_crest_factor) as current_crest_factor_avg, min(active_power) as active_power_min, max(active_power) as active_power_max, avg(active_power) as active_power_avg, min(reactive_power) as reactive_power_min, max(reactive_power) as reactive_power_max, avg(reactive_power) as reactive_power_avg, min(power_factor) as power_factor_min, max(power_factor) as power_factor_max, avg(power_factor) as power_factor_avg, min(frequency) as frequency_min, max(frequency) as frequency_max, avg(frequency) as frequency_avg, min(thd_phase_voltage) as thd_phase_voltage_min, max(thd_phase_voltage) as thd_phase_voltage_max, avg(thd_phase_voltage) as thd_phase_voltage_avg, min(thd_phase_current) as thd_phase_current_min, max(thd_phase_current) as thd_phase_current_max, avg(thd_phase_current) as thd_phase_current_avg, min(temperature) as temperature_min, max(temperature) as temperature_max, avg(temperature) as temperature_avg, min(voltage_harmonics) as voltage_harmonics_min, max(voltage_harmonics) as voltage_harmonics_max, avg(voltage_harmonics) as voltage_harmonics_avg, min(current_harmonics) as current_harmonics_min, max(current_harmonics) as current_harmonics_max, avg(current_harmonics) as current_harmonics_avg, min(apparent_power) as apparent_power_min, max(apparent_power) as apparent_power_max, avg(apparent_power) as apparent_power_avg, min(inverter_conversion_efficiency) as inverter_conversion_efficiency_min, max(inverter_conversion_efficiency) as inverter_conversion_efficiency_max, avg(inverter_conversion_efficiency) as inverter_conversion_efficiency_avg, min(electric_charge) as electric_charge_min, max(electric_charge) as electric_charge_max, avg(electric_charge) as electric_charge_avg, min(line_voltage_R_S) as line_voltage_R_S_min, max(line_voltage_R_S) as line_voltage_R_S_max, avg(line_voltage_R_S) as line_voltage_R_S_avg, min(line_voltage_S_T) as line_voltage_S_T_min, max(line_voltage_S_T) as line_voltage_S_T_max, avg(line_voltage_S_T) as line_voltage_S_T_avg, min(line_voltage_T_R) as line_voltage_T_R_min, max(line_voltage_T_R) as line_voltage_T_R_max, avg(line_voltage_T_R) as line_voltage_T_R_avg, min(accumulate_power_consumption) as accumulate_power_consumption_min, max(accumulate_power_consumption) as accumulate_power_consumption_max, avg(accumulate_power_consumption) as accumulate_power_consumption_avg, min(dc_voltage) as dc_voltage_min, max(dc_voltage) as dc_voltage_max, avg(dc_voltage) as dc_voltage_avg, min(dc_current) as dc_current_min, max(dc_current) as dc_current_max, avg(dc_current) as dc_current_avg, min(dc_electric_power) as dc_electric_power_min, max(dc_electric_power) as dc_electric_power_max, avg(dc_electric_power) as dc_electric_power_avg, min(dc_ampere) as dc_ampere_min, max(dc_ampere) as dc_ampere_max, avg(dc_ampere) as dc_ampere_avg, min(accumulate_dc_power_consumption) as accumulate_dc_power_consumption_min, max(accumulate_dc_power_consumption) as accumulate_dc_power_consumption_max, avg(accumulate_dc_power_consumption) as accumulate_dc_power_consumption_avg FROM tbl_metering_group_data WHERE serial_id='506583E5EE8A' AND created_ts BETWEEN 1515508500000000001 AND 1515508800000000000 GROUP BY serial_id, group_id, FLOOR(created_ts/ (1000000000 * 60 * 5 ));
