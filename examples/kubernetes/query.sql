SELECT ( FLOOR(created_ts/ (1000000000 * 60 * 60 ) + 1) * 1000000000 * 60 * 60 ) DIV 1, NOW(), serial_id, group_id, min(phase_voltage_min) as phase_voltage_min, max(phase_voltage_max) as phase_voltage_max, avg(phase_voltage_avg) as phase_voltage_avg, min(line_voltage_min) as line_voltage_min, max(line_voltage_max) as line_voltage_max, avg(line_voltage_avg) as line_voltage_avg, min(voltage_crest_factor_min) as voltage_crest_factor_min, max(voltage_crest_factor_max) as voltage_crest_factor_max, avg(voltage_crest_factor_avg) as voltage_crest_factor_avg, min(phase_current_min) as phase_current_min, max(phase_current_max) as phase_current_max, avg(phase_current_avg) as phase_current_avg, min(current_crest_factor_min) as current_crest_factor_min, max(current_crest_factor_max) as current_crest_factor_max, avg(current_crest_factor_avg) as current_crest_factor_avg, min(active_power_min) as active_power_min, max(active_power_max) as active_power_max, avg(active_power_avg) as active_power_avg, min(reactive_power_min) as reactive_power_min, max(reactive_power_max) as reactive_power_max, avg(reactive_power_avg) as reactive_power_avg, min(power_factor_min) as power_factor_min, max(power_factor_max) as power_factor_max, avg(power_factor_avg) as power_factor_avg, min(frequency_min) as frequency_min, max(frequency_max) as frequency_max, avg(frequency_avg) as frequency_avg, min(thd_phase_voltage_min) as thd_phase_voltage_min, max(thd_phase_voltage_max) as thd_phase_voltage_max, avg(thd_phase_voltage_avg) as thd_phase_voltage_avg, min(thd_phase_current_min) as thd_phase_current_min, max(thd_phase_current_max) as thd_phase_current_max, avg(thd_phase_current_avg) as thd_phase_current_avg, min(temperature_min) as temperature_min, max(temperature_max) as temperature_max, avg(temperature_avg) as temperature_avg, min(voltage_harmonics_min) as voltage_harmonics_min, max(voltage_harmonics_max) as voltage_harmonics_max, avg(voltage_harmonics_avg) as voltage_harmonics_avg, min(current_harmonics_min) as current_harmonics_min, max(current_harmonics_max) as current_harmonics_max, avg(current_harmonics_avg) as current_harmonics_avg, min(apparent_power_min) as apparent_power_min, max(apparent_power_max) as apparent_power_max, avg(apparent_power_avg) as apparent_power_avg, min(inverter_conversion_efficiency_min) as inverter_conversion_efficiency_min, max(inverter_conversion_efficiency_max) as inverter_conversion_efficiency_max, avg(inverter_conversion_efficiency_avg) as inverter_conversion_efficiency_avg, min(electric_charge_min) as electric_charge_min, max(electric_charge_max) as electric_charge_max, avg(electric_charge_avg) as electric_charge_avg, min(line_voltage_R_S_min) as line_voltage_R_S_min, max(line_voltage_R_S_max) as line_voltage_R_S_max, avg(line_voltage_R_S_avg) as line_voltage_R_S_avg, min(line_voltage_S_T_min) as line_voltage_S_T_min, max(line_voltage_S_T_max) as line_voltage_S_T_max, avg(line_voltage_S_T_avg) as line_voltage_S_T_avg, min(line_voltage_T_R_min) as line_voltage_T_R_min, max(line_voltage_T_R_max) as line_voltage_T_R_max, avg(line_voltage_T_R_avg) as line_voltage_T_R_avg, min(accumulate_power_consumption_min) as accumulate_power_consumption_min, max(accumulate_power_consumption_max) as accumulate_power_consumption_max, avg(accumulate_power_consumption_avg) as accumulate_power_consumption_avg, min(dc_voltage_min) as dc_voltage_min, max(dc_voltage_max) as dc_voltage_max, avg(dc_voltage_avg) as dc_voltage_avg, min(dc_current_min) as dc_current_min, max(dc_current_max) as dc_current_max, avg(dc_current_avg) as dc_current_avg, min(dc_electric_power_min) as dc_electric_power_min, max(dc_electric_power_max) as dc_electric_power_max, avg(dc_electric_power_avg) as dc_electric_power_avg, min(dc_ampere_min) as dc_ampere_min, max(dc_ampere_max) as dc_ampere_max, avg(dc_ampere_avg) as dc_ampere_avg, min(accumulate_dc_power_consumption_min) as accumulate_dc_power_consumption_min, max(accumulate_dc_power_consumption_max) as accumulate_dc_power_consumption_max, avg(accumulate_dc_power_consumption_avg) as accumulate_dc_power_consumption_avg FROM tbl_metering_group_data_30_min WHERE serial_id='F45EAB3D974F' AND created_ts BETWEEN 1515571200000000000 AND 1515574799000000000 GROUP BY serial_id, group_id, FLOOR(created_ts/ (1000000000 * 60 * 60 ))
